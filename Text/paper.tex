\documentclass{article}
\usepackage[numbers,sort&compress]{natbib}
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{bm}
\usepackage{color}
\begin{document}
\begin{abstract}
Recently we investigated the applicability and parameters choice for the two-dimensional case
Bretherton problem using the lattice Boltzmann method (LBM) \cite{kuzmin-binary2d}. This
paper is the continuation of the previous work and is focused on the three-dimensional case to
validate the LBM for simulation of phenomena for rectangular and square capillaries in the
moderate range of Capillary number parameters. 
\end{abstract}

\section{What to examine}
My plan is to investigate preferably the low capillary number regims as far we have interesting
phenomena occuring where: the axisymmetric radiuses for axes and diagonals. As far as it's
computationally very expensive to resolve the film thickness, it will be nice to investigate
whether underresolved films simulations can produce consistent results. The second thing to study
is the velocity pattern which is much easier to examine because the threshold is located for
$Ca\approx 0.6$. The third thing to study is the film thickness dependancy for the range of
capillary numbers. The last thing to study is the applicability of derived by \citet{heil-threedim}
correlations for rectangular channels of different shapes.

\section{Introduction}
While for two-dimensional Bretherton flow the results are usually limited to the circular shape and
only some of them are for the plane-symmetric case \cite{giavedoni-numerical,heil-bretherton},
vast number of experimental results and simulations are available for the three-dimensional case.
It was found that the for rectangular and/or square shaped capillaries there is a transition for
certain capillary number, where the flow changes from the non axisymmetric to axis symmetric case.
Non axisymmetric case is attributed to the case where the axial radius is different from the
diagonal radius and the bubble has the non-circular shape in the channel crossection, see the
example in Fig. \ref{fig:quarter:capillary:capillary01} for a non-axisymmetric case.

The transition number between non-axisymmetric case and symmetric is indicated in a number of
works as $\widehat{Ca}=0.04$ \cite{cerro-bubble-train},
$\widehat{Ca}=0.1$
\cite{cerro-space}, $\widehat{Ca}=0.033$ \cite{heil-threedim}. If the capillary number is larger
than
the critical capillary number, i.e. $Ca>\widehat{Ca}$, then the flow becomes axisymmetric with the
radius of the droplet dependant on the capillary number. One of the example for the film
thickness dependency on the capillary number is in Fig. \ref{fig:heil:three:dim}.

\citet{heil-threedim} performed three-dimensional simulations for circular shaped and for the
square shaped capillaries and gravitational effects for circular shaped capillaries. The results for
square capillaries are shown in Fig.\ref{fig:heil:three:dim}. Also, authors performed
numerical simulations for rectangular shaped capillaries. It was found that for different shaped
capillaries there is an empirical correlation allowing to put all the different curves for film
thickness dependency on the capillary number on one curve through introduction of the following
parameter
$s_{\infty}=r_{\infty} \alpha^{-1/2}$. The parameter $r_{\infty}$ is the aximsymmetric bubble radius
infinitely far behind the bubble tip and can be calculated as:
\begin{equation}
r_{\infty}=2\sqrt{(\alpha-Q)/\pi},
\end{equation}
where $Q$ is the net flow rate in the computational domain. {\color{red} What is it? - how to
calculate? Why velocity is involved?}

It is also indicated that for $\alpha\geq\hat{\alpha}=2.04$ the interface can not make up the
axisymmetric case for the range of capillary numbers. The $s_{\infty}$ dependency on $\alpha$ is
shown in Fig.
\ref{fig:heil:three:dim}.
\begin{figure}
\includegraphics[width=0.47\textwidth]{Figures/capillary_width_heil.eps}\hfill
\includegraphics[width=0.47\textwidth]{Figures/capillary_rectangular_width_heil.eps}\\
\caption{\citet{heil-threedim} results for the variation of the deposited liquid for the range of
capillary number. One can see the asymmetry between diagonal and axis diameter for the capillary
number $Ca\leq\hat{Ca}=0.04$. Courtesy of \citet{heil-threedim}. \label{fig:heil:three:dim}}
\end{figure}

\citet{heil-threedim} indicate the interesting occuring thing in square and rectangular channels
as the recirculating regime for flow fields.  It is
known that for certain capillary number the streamlines either go around the bubble or create the
circulating regime in front of the bubble, Fig. \ref{fig:heil:recirculating}.  
\begin{figure}
\includegraphics[width=0.97\textwidth]{Figures/recirculating.eps}
\caption{Two different regimes for recirculation. Courtesy of \citet{heil-threedim}. 
Streamlines in the moving frame of reference for a rectangular tube $\alpha=1.5$ (a) Ca = 0.2,
(b) Ca = 0.5, (c) Ca = 0.55, (d) Ca = 2.0. Streamlines are shown on the surface of the bubble and
in the plane along the shorter semi-axis.
\label{fig:heil:recirculating}}
\end{figure}
The critical capillary numbers for changing velocity pattern depending on the eccentricity
parameter $\alpha$ are presented in Table \ref{table:recirculation:data}.
\begin{table}
\begin{tabular}{c|c}
$\alpha$& $Ca_{T}$\\
\hline
1& 0.691\\
1.1 & 0.688\\
1.3 & 0.666\\
1.5 & 0.631\\
\end{tabular}
\caption{The results for the recirculation region.\label{table:recirculation:data}}
\end{table}

\citet{shikazono-square} obtained a lot of different results for the deposition length versus the
capillary number variation ethanol/air and water/air experiments. All of them are
presented in Fig. \ref{fig:deposition:han}.
\begin{figure}
%\includegraphics[width=0.47\textwidth]{Figures/han_capillary_fc40_air.eps}\hfill
\includegraphics[width=0.47\textwidth]{Figures/han_capillary_water_air.eps}\hfill
\includegraphics[width=0.47\textwidth]{Figures/han_capillary_ethanol_air.eps}\\
\caption{The axial and diagonal radiuses dependency on the capillary number. Courtesy of
\citet{shikazono-square} \label{fig:deposition:han}}
\end{figure}

\citet{cerro-bubble-train} performed a lot of experiments for a buble-train flow in capillaries of
circular and square cross section for horizontal, upward and downward flows. The main results are
presented in Fig. \ref{fig:thulasidas:results}.
\begin{figure}
\includegraphics[width=0.47\textwidth]{Figures/thulasidas_capillary.eps}\hfill
\includegraphics[width=0.47\textwidth]{Figures/thulasidas_relative_velocity.eps}\\
\caption{\citet{cerro-bubble-train} results for the film thickness
variation and the relative bubble velocity versus the capillary
number.\label{fig:thulasidas:results}}
\end{figure}

\citet{wang-non-circular} performed numerical simulations by VOF technique to for the non-circular
shaped capillaries as square and triangle shaped capillaries. The VOF technique is the continuous
interface method based on the non-uniform grid. It is of particular interest for us to compare it
with the continuous interface method by the LBM implementation. Some interesting results are
obtained for a bubble
shape depending on the capillary number, Fig. \ref{fig:wang:bubble:shape}. They also included
numerical simulations for the determination of the critical capillary number $\hat{Ca}$, Fig.
\ref{fig:wang:critical:capillary}. They also found the relative velocity for the bubble for
different capillary numbers.
\begin{figure}
\includegraphics[width=\textwidth]{Figures/wang_bubble_shape.eps}
\caption{The bubble shape across the length for different capillary numbers.
\label{fig:wang:bubble:shape}}
\end{figure}
\begin{figure}
\includegraphics[width=0.47\textwidth]{Figures/wang_critical_capillary.eps}\hfill
\includegraphics[width=0.47\textwidth]{Figures/wang_relative_velocity.eps}
\caption{Bubble radiuses variations over the range of capillary numbers (left) and the relative
velocity depending on the capillary number.  \label{fig:wang:critical:capillary}}
\end{figure}

\section{Non-axisymmetric case}
We first start with the non-axisymmetric case. As it was indicated before for a quite low capillary
number the flow becomes axisymmetric. For
example, according to \cite{heil-threedim} for the capillary
number $Ca=0.01$, the axis and diagonal radiuses are $r_h=0.99$ and $r_d=1.1$ respectively.
Therefore the film thickness in the axial direction is  $0.5\%$ of whole channel width to see the
difference. Our previous calculations \cite{kuzmin-binary2d} show that the film thickness should be
 resolved around $40-50$ percent for calculations to be convergent and grid independent. This
condition certainly implies a large grid with the computational high demand. For instance, to
properly simulate the abovementioned example the grid should be as 
$200x200x3000$ nodes. In this section we want to examine the assumption of the underresolved
interface whether it can produce the consistent film thicknesses for low capillary numbers. The
interface occupies around $1-2$ lattice units. 

Here we present simulations for the domain of size $52\mathrm{x}52\mathrm{x}1500$ which simulates
the quarter of the channel using the mirror boundary conditions (Section \ref{append:sym}). That
results in the effective grid size as $100\mathrm{x}100\mathrm{x}1500$. The simulation is carried
out with the pressure gradient as:
\begin{equation}
\frac{\mathrm{d}P}{\mathrm{d}x}=1.6\,10^{-6}.
\end{equation}
The initial film thickness was taken as $6$ nodes. 

One can see the phase profile in the middle of the bubble in
Fig.\ref{fig:quarter:capillary:capillary01}. The associated capillary number is $0.053$ based on
the calculation of the bubble velocity in the center of the bubble. The radiuses in this simulation
are as $R_{axis}=0.93$ and $R_{diag}=1.06$. While $R_{axis}=0.93$ is underestimated parameter and
we can't take into the consideration apriori, one can consider parameter $R_{diag}=1.06$ the
parameters for the capillary number $0.053$ should be according to \citet{heil-threedim} as $0.97$
and $1.05$ according to the VOF simulations of \citet{wang-non-circular}. One can conclude that
even though the axis film thickness is not properly resolved the diagonal values are consistent and
can give an approximate information. 
\begin{figure}
\includegraphics[width=0.97\textwidth]{Figures/quarter.eps}\\ %\hfill
\includegraphics[width=0.97\textwidth]{Figures/stream_cap01.eps}\\
\caption{Streamlines and phase profile of the quarter of the channel. The capillary number is
$0.053$ and the film thickness is underresolved. \label{fig:quarter:capillary:capillary01}}
\end{figure}
{\color{red} Add more data here either with better grid or with the less velocity that we can
track the numbers.}


\section{Variation bubble length}
The works of \citet{heil-threedim} of \citet{wang-non-circular} show the variation of the bubble
thickness through the length of
bubble. The length variation is presented in Fig.\ref{fig:thickness:variation:ca:ten} and
Fig.\ref{fig:wang:bubble:shape}. While Fig. \ref{fig:wang:bubble:shape} indicates that the diagonal
radius has a variation for the rather small capillary numbers as $Ca<0.1$, another profile is
presented for the $Ca=10$ and shows the variation for the diagonal radius. We examined a bunch of
different capillaries numbers to present the diagonal radius variations over the length:
The axis and diagonal radiuses variation over the bubble are shown in Figure
\ref{fig:bubble:variation:capillaries}. The rather small capillary numbers one can see the increase
in the rear menisci of the diagonal radius which coincides with the results of
\citet{wang-non-circular}.
\begin{figure}[ht]
\includegraphics[width=0.47\textwidth]{Figures/bubble_length_ca_36.eps}\hfill
\includegraphics[width=0.47\textwidth]{Figures/bubble_length_ca_61.eps}\\
\includegraphics[width=0.47\textwidth]{Figures/bubble_length_ca_88.eps}\hfill
\includegraphics[width=0.47\textwidth]{Figures/bubble_length_ca_117.eps}\\
\caption{The radiuses variations for the capillary number $Ca=0.46$.
One can see the diagonal radius different from the axial radius near the front of the tip which is
somehow coincides with the results of
\citet{heil-threedim}. The results are presented for the
capillary numbers (from left to right, top to bottom)
$0.36$, $0.61$, $0.88$, $1.17$. \label{fig:bubble:variation:capillaries}}
\end{figure}
\begin{figure}
\includegraphics[width=0.97\textwidth]{Figures/variationoverlength.eps}
\caption{The variation of the bubble length for capillary number $Ca=10$. The x-axis scaled to
half-width of the microchannel height.  \label{fig:thickness:variation:ca:ten}}
\end{figure}

Concerning results indicated in Fig.
\ref{fig:thickness:variation:ca:ten} simulations are unstable that means one needs to work with
small surface tension ({\color{red} See results of Pagonabarraga}). One can see that the difference
between diagonal radius and
usual radius is of order of $4\%$. That means it's 2 percent of the channel height. If the
simulation is conducted by the grid $50\mathrm{x}50$ in the cross section that means that we will
see the difference in one grid node. Therefore the grid is $52\mathrm{x}52\mathrm{750}$. Here we
conduct a scaling:
\begin{equation}
Ca=\frac{\mu_{liq} U_{bubble}}{\gamma}
\end{equation}
The parameters for the binary liquid problem are chosen as $A=0.04$ and $k=0.01$. Therefore the
surface tension is:
\begin{equation}
\sigma = \sqrt{\frac{8 k A}{9}}=0.0596
\end{equation}
The relaxation times for liquid and gas are taken as, $\tau_{gas}=0.7$ and $\tau_{liq}=2.5$,
therefore the viscosities ratio is $10$.
\begin{equation}
\begin{aligned}
&10=\frac{\frac{2}{3} U_{bubble}}{0.0596},
&U_{bubble}=0.894
\end{aligned}
\end{equation}
which is quite high for the lattice Boltzmann method. We can decrease the ratio by scaling
parameters $k$ and $A$ while keeping the interface thickness. Let us choose parameters as $k=0.001$
and $A=0.004$, therefore the mobility should be adjusted to address the issue with small parameters
and small surface tension in this case. It parameters are chosen as $A=0.004$ and $k=0.001$ then
the velocity of the bubble is  $0.0894$. Therefore we can adjust the pressure gradient to plug it
into the bubble initialization:
\begin{equation}
\frac{\mathrm{d}P}{\mathrm{d}x}=\frac{8}{N_y^2} \gamma Ca=0.0001907,
\end{equation}
which is quite high for lattice Boltzmann simulations. Therefore probably one more time the surface
tension needs to be reduced. {\color{red} Many authors state that increasing mobility kills the
proper results of simulations}. 
The film thickness as it is seen from the picture is taken as $70$ percent of the half channel.
Therefore the initalization width is $0.15*50=7.5$. 


\section{Capillary number}
 The
dimensionalization case is therefore as follows. Instead of starting with the capillary number
simulations we initialize the initial thickness with $2.5$ lattice boltzmann units, change the
pressure gradients through the following numbers:
\begin{equation}
\frac{\mathrm{d}P}{\mathrm{d}x}=
\begin{cases}
1\dots10\mathrm{x}10^{-6}\\
10,15\dots 100 \mathrm{x}10^{-6}
\end{cases}
\end{equation}
After performing the simulations we determine the $R_{axis}$, $R_{diag}$ versus calculated
capillary number
\begin{equation}
Ca=\frac{\mu_{liq} U_{bubble}}{\gamma}.
\end{equation}
To perform simulations we
started with the following parameters as
$k=0.04$,$A=0.04$,$\Gamma=1.0$,$N_x\mathrm{x}N_y\mathrm{x}N_z=52\mathrm{x}52\mathrm{x}750$.
For underresolved schemes, the pressure gradient doesn't work in the way we expect. Therefore, we
take pressure gradient in the following way and later on establish the associated capillary number.
We want to keep track of $R_{diag}$ when the $R_{axis}$ is underresolved. The preliminary results
for the film thickness measured in the middle of the bubble are shown in Fig.
\ref{fig:underresolved:capillaries}. 
\begin{figure}
\includegraphics[width=0.97\textwidth]{Figures/underresolved_capillaries.eps}
\caption{The underresolved profiles axis and diagonal radiuses versus capillary numbers. $50$
percent resolution starts from $Ca=1.0$, which is quite high. One can see it's exactly where
radiuses converge instead of $Ca=0.04$. However, one can see from simulations Fig.
\ref{fig:wang:critical:capillary} and Fig.\ref{fig:thickness:variation:ca:ten} the thickness,
especially for Fig.\ref{fig:thickness:variation:ca:ten}, can significantly variate over a bubble
length. \label{fig:underresolved:capillaries}}
\end{figure}

One can see the variation of thickness over the bubble length for the given capillary $Ca=1.06$ in
Fig. \ref{fig:variation:bubble:ca:one}. One can see that variation over the length can be neglected
for relatively high $Ca$ numbers.
\begin{figure}
\includegraphics[width=0.97\textwidth]{Figures/bubble_length_ca_one.eps}
\caption{The bubble length variation over for given $Ca=1.06$.
One can see that there is no such high variation over the bubble
length. \label{fig:variation:bubble:ca:one}}
\end{figure}


\section{Steady-state case}
We performed different simulations to understand a number of steps required for the problem to come
on the steady-state. The grid to be simulated is $52\mathrm{x}52\mathrm{x}750$ which simulates the
quarter of the channel with the initial
width as $6.5$ lattice Boltzmann units together with $\frac{\mathrm{d}P}{\mathrm{d}x}=1.6
\mathrm{x}10^{-6}$. The simulation was performed for $140000$,$150000$,$160000$, $170000$ and
$180000$ iterations. The results are summarised in Table \ref{table:steady:state}. Whole the
capillary number varies only in the 4th digit, radiuses are one percent accurate. 

One of the
profiles in
the middle of the bubble is shown in Fig. \ref{fig:steady:state:profile:example}.
\begin{table}
\begin{tabular}{|c|c|c|c|}
$N_{iter}$&$Ca$&$R_{axis}$&$R_{diag}$\\
$140000$&$0.0532$&$0.9379$&$1.075$\\
$150000$&$0.0533$&$0.9375$&$1.072$\\
$160000$&$0.0535$&$0.9372$&$1.069$\\
$170000$&$0.0536$&$0.9369$&$1.066$\\
$180000$&$0.0537$&$0.9366$&$1.062$\\
\end{tabular}
\caption{Results for the steady-state case. One can see that $200000$ steps are enough to structure
the bubble. However, the interface is underresolved. That could be the influence of the bubble
length.\label{table:steady:state}}
\end{table}
\begin{figure}
\includegraphics[width=0.47\textwidth]{Figures/bullet.eps}\hfill
\includegraphics[width=0.47\textwidth]{Figures/example_crossection.eps}\\
\caption{Slice in the middle of the bubble and
three-dimensional example. \label{fig:steady:state:profile:example}}
\end{figure}


To understand the influence of the steady-state case
For the steady-state regime the following parameters were obtained
We want to perform understanding of the steady state regime. As well probably it's good idea to
change domain as well, to reduce the length but to insure enough length of the bubble. The
steady-state calculations are performed on $52\mathrm{x}52\mathrm{x}750$ with large enough the
interface. 

\section{Capillary number region}
The same as in the previous example can help us to identify the necessary capillary regime. The
most important thing is to establish different accentricity factors.

\section{Train simulation}
As far as the requirements for the grid are ``heavy'' we performed a bunch of simulations to
examine how the distance between bubbles influences on the thickness. For this purpose the
simulation was conducted on the grid 82x82x750. We examined different initialized distances between
bubbles. The initial lengths of bubbles were chosen as $300$, $350$, $400$, $450$, $500$, $550$
lattice units. Therefore, the corresponding initial distances between bubbles are
$450$,$400$,$350$,$300$,$250$ lattice units. On the steady state regime the distances become $386$,
$317$, $248$,$176$,$99$,$23$ lattice units. The corresponding capillary numbers calculated based on
the center bubble velocity are as follows $0.905$, $0.986$,$1.08$,$1.19$, $1.33$, $1.49$. The
calculated radiuses (diagonal radius equal to the axes radius) are as follows
$0.783$,$0.778$,$0.772$,$0.764$,$0.753$,$0.747$. Thus, one can see the great impact of the bubbles
on each other velocity for the given body force. However, in terms of the film thicknesses those
numbers look adequate. One can see the film thicknesses dependency on the capillary number for
simulations obtained by \citet{heil-threedim} and bubble train simulations data in Fig.
\ref{fig:capillaries:train}. One can see that the results are consistent and in a good agreement.
Therefore, though the bubble train mutual motion influences on the film thickness by increasing the
associated capillary number,  however, the film thickness is in accordance with the capillary
number correlation. Thus, the decrease of the numerical domain is quantified and can be used to
obtain the data. However, one should be cautious about the initialization, because the Poiseuille
flow initialization is deviated even further due to mutual motion of bubbles.
\begin{figure}
\includegraphics[width=0.97\textwidth]{Figures/capillaries_comparison_train.eps}
\caption{The comparison for the film thickness between \citet{heil-threedim} data and bubble train
simulations. Though, one can see that the decrease of the distance between bubbles causes the
increase in the associated capillary number, however, the correlation dependance between film
thickness and capillary number stays the same. This can help for simulations to reduce the
numerical domain. \label{fig:capillaries:train}}
\end{figure}


\section{Simulation setup}

\appendix{Symmetric boundary conditions}
\label{append:sym}
For the memory save we performed the simulation of the quarter of the channel while using the
antisymmetric boundary conditions. In the macroscopic variables the mirror boundary conditions
require to have the same scalar fields, but for velocity only tangential velocities are the same
but perpendicular have the opposite directions. This implies the following in terms of the
macroscopic variables:
\begin{equation}
\rho_B = \rho_F, \quad \phi_B = \phi_F \quad U_{B\tau}=U_{F\tau}, U_{B n}=U_{F n}, 
\end{equation}
 where $B$ and $F$ stand for the boundary and the nearest fluid node, respectively. 

In terms of the lattice Boltzmann populations this conditions require the same set of the
populations for the boundary node as for the fluid node. However, the set is mirrored against the
plane of the boundary. This case allows to conserve scalar fields, to have the same tangential
velocities and to have opposite normal velocities. The grid was chosen as 52x52x1500, which is the
effective calculated domain as 100x100x1500 grid nodes. 

\bibliographystyle{unsrtnat}
\bibliography{paper}
\end{document}


